<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatura #{{ invoice.id }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 14px;
            margin: 20px;
        }
        .invoice-box {
            max-width: 800px;
            margin: auto;
            padding: 30px;
            border: 1px solid #eee;
            box-shadow: 0 0 10px rgba(0, 0, 0, .15);
            font-size: 16px;
            line-height: 24px;
            color: #555;
        }
        .invoice-box table {
            width: 100%;
            line-height: inherit;
            text-align: left;
        }
        .invoice-box table td {
            padding: 5px;
            vertical-align: top;
        }
        .invoice-box table tr td:nth-child(2) {
            text-align: right;
        }
        .invoice-box table tr.top table td {
            padding-bottom: 20px;
        }
        .invoice-box table tr.top table td.title {
            font-size: 45px;
            line-height: 45px;
            color: #333;
        }
        .invoice-box table tr.information table td {
            padding-bottom: 30px;
        }
        .invoice-box table tr.heading td {
            background: #eee;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
        }
        .invoice-box table tr.details td {
            padding-bottom: 20px;
        }
        .invoice-box table tr.item td {
            border-bottom: 1px solid #eee;
        }
        .invoice-box table tr.item.last td {
            border-bottom: none;
        }
        .invoice-box table tr.total td:nth-child(2) {
            border-top: 2px solid #eee;
            font-weight: bold;
        }
        .signatures {
            margin-top: 50px;
            display: flex;
            justify-content: space-around;
            text-align: center;
        }
        .signature-block {
            width: 45%;
            padding-top: 20px;
            border-top: 1px solid #aaa;
        }
        .signature-image {
            max-width: 150px; /* Ajuste conforme o tamanho da sua imagem de assinatura */
            height: auto;
            display: block;
            margin: 0 auto 10px auto;
        }
        @media only screen and (max-width: 600px) {
            .invoice-box table tr.top table td {
                width: 100%;
                display: block;
                text-align: center;
            }
            .invoice-box table tr.information table td {
                width: 100%;
                display: block;
                text-align: center;
            }
            .signatures {
                flex-direction: column;
            }
            .signature-block {
                width: 100%;
                margin-bottom: 30px;
            }
        }
        .rtl {
            direction: rtl;
            font-family: Tahoma, 'Helvetica Neue', 'Helvetica', Helvetica, Arial, sans-serif;
        }
        .rtl table {
            text-align: right;
        }
        .rtl table tr td:nth-child(2) {
            text-align: left;
        }
        .footer {
            margin-top: 50px;
            text-align: center;
            font-size: 12px;
            color: #777;
        }
        /* Styles for print */
        @media print {
            body {
                margin: 0;
                padding: 0;
            }
            .invoice-box {
                box-shadow: none;
                border: none;
            }
            .no-print {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="invoice-box">
        <table cellpadding="0" cellspacing="0">
            <tr class="top">
                <td colspan="2">
                    <table>
                        <tr>
                            <td class="title">
                                {# LOGO DA LOJA #}
                                <img src="{{ url_for('static', filename='images/logo.png') }}" style="width:100%; max-width:150px;" alt="Logo da BzMD Cell">
                            </td>
                            <td>
                                Fatura #: {{ invoice.id }}<br>
                                Data de Emissão: {{ invoice.issue_date.strftime('%d/%m/%Y') }}<br>
                                {% if invoice.due_date %}Data de Vencimento: {{ invoice.due_date.strftime('%d/%m/%Y') }}{% endif %}
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>

            <tr class="information">
                <td colspan="2">
                    <table>
                        <tr>
                            <td>
                                **De:**<br>
                                {# INFORMAÇÕES DA EMPRESA ATUALIZADAS #}
                                BzMD Cell<br>
                                24 99305-9333<br>
                                bzmdstore@yahoo.com<br>
                                Estr. União e Indústria, 1000, Itaipava, Petrópolis - RJ
                            </td>
                            <td>
                                **Para:**<br>
                                {{ invoice.os.client.name }}<br>
                                {{ invoice.os.client.email if invoice.os.client.email else '' }}<br>
                                {{ invoice.os.client.phone if invoice.os.client.phone else '' }}
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>

            <tr class="heading">
                <td>Item</td>
                <td>Preço</td>
            </tr>

            <tr class="item">
                <td>
                    Serviço: {{ invoice.os.service.name }} <br>
                    Descrição da OS: {{ invoice.os.description }}
                </td>
                <td>R$ {{ "%.2f"|format(invoice.total_amount) }}</td>
            </tr>

            <tr class="total">
                <td></td>
                <td>Total: R$ {{ "%.2f"|format(invoice.total_amount) }}</td>
            </tr>

            <tr class="heading">
                <td colspan="2">Detalhes de Pagamento</td>
            </tr>
            <tr class="details">
                <td colspan="2">
                    Status: <span class="badge 
                        {% if invoice.payment_status == 'Pendente' %}bg-warning text-dark{% elif invoice.payment_status == 'Pago' %}bg-success{% elif invoice.payment_status == 'Atrasado' %}bg-danger{% elif invoice.payment_status == 'Parcial' %}bg-info{% endif %}">
                        {{ invoice.payment_status }}
                    </span>
                    {% if invoice.notes %}
                        <br>Observações: {{ invoice.notes }}
                    {% endif %}
                </td>
            </tr>
        </table>

        {# ÁREA DE ASSINATURAS #}
        <div class="signatures">
            <div class="signature-block">
                <img src="{{ url_for('static', filename='images/signature.png') }}" alt="Assinatura do Técnico" class="signature-image">
                <span>___________________________________</span><br>
                <span>Assinatura do Técnico: {{ invoice.user.username if invoice.user else 'N/A' }}</span>
            </div>
            <div class="signature-block">
                <br><br> {# Espaço para a assinatura física do cliente #}
                <span>___________________________________</span><br>
                <span>Assinatura do Cliente: {{ invoice.os.client.name }}</span>
            </div>
        </div>

        <div class="footer">
            Obrigado(a) por fazer negócios conosco!
            <p>Por favor, efetue o pagamento até a data de vencimento.</p>
        </div>
    </div>
</body>
</html>